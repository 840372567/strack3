$(function(){function a(a){Strack.open_dialog("dialog",{title:CategoryPHP.ModifyCategory,width:480,height:190,content:Strack.dialog_dom({type:1,hidden:[{case:101,id:"Mcategory_id",type:"hidden",name:"category_id",valid:1,value:a.category_id}],items:[{case:1,id:"Mcategory_name",type:"text",lang:StrackPHP.Name,name:"category_name",valid:1,value:a.category_name,mask:"*{1,64}"}],footer:[{obj:"category_update",type:1,title:StrackPHP.Update},{obj:"dialog_cancel",type:8,title:StrackPHP.Cancel}]}),inits:function(){$("#st_dialog_form :input").inputmask()},close:function(){t.datagrid("reload")}})}obj={category_add:function(){var a=$("#category_name").val();a.length<1?layer.msg(CategoryPHP.CategoryName_Null,{icon:2,time:1200,anim:6}):$.ajax({type:"POST",url:CategoryPHP.AddCategory,data:{category_name:a},beforeSend:function(){$.messager.progress({title:StrackPHP.Waiting,msg:StrackPHP.loading})},success:function(a){switch($.messager.progress("close"),JSON.parse(a).status){case-1:layer.msg(CategoryPHP.CategoryName_Length,{icon:7,time:1200,anim:6});break;case-2:layer.msg(CategoryPHP.CategoryName_CF,{icon:7,time:1200,anim:6});break;case 200:$("#category_name").val(""),Strack.top_message({bg:"g",msg:CategoryPHP.AddCategorySc}),$("#datagrid_box").datagrid("reload")}}})},category_modify:function(){var e=t.datagrid("getSelections");e.length<1?layer.msg(StrackPHP.Please_Select_One,{icon:2,time:1200,anim:6}):e.length>1?layer.msg(StrackPHP.Only_Choose_One,{icon:2,time:1200,anim:6}):a(e[0])},category_update:function(){Strack.ajax_dialog_form("#st_dialog_form input",e,CategoryPHP.MDCategory,{back:function(a){switch(JSON.parse(a).status){case-1:layer.msg(CategoryPHP.CategoryName_Length,{icon:7,time:1200,anim:6});break;case-2:layer.msg(CategoryPHP.CategoryName_CF,{icon:7,time:1200,anim:6});break;case 200:Strack.top_message({bg:"g",msg:CategoryPHP.MDCategorySc}),Strack.dialog_cancel()}}})},category_delete:function(){for(var a=t.datagrid("getSelections"),e=[],o=0;o<a.length;o++)e.push(a[o].category_id);Strack.ajax_grid_delete(a,CategoryPHP.DeCategory_notice,CategoryPHP.DECategory,{category_ids:e.join(",")},"",CategoryPHP.DECategorySc)}},$(":input").inputmask();var e={};e["category_name-1"]=CategoryPHP.CategoryName_Null;var t=$("#datagrid_box").datagrid({url:CategoryPHP.DataCategory,rownumbers:!0,nowrap:!0,fitColumns:Strack.FitColumns(".admin-dept-right",1004),height:Strack.panel_height(".admin-dept-right",0),adaptive:{dom:".admin-dept-right",min_width:1004},DataNull:CategoryPHP.GridCategoryNull,columns:[[{field:"category_id",align:"center",checkbox:!0},{field:"category_name",title:StrackPHP.Category,align:"center",width:260}]],toolbar:"#tb",pagination:!0,pageSize:100,pageList:[100,200],pageNumber:1,pagePosition:"bottom",remoteSort:!1,onDblClickRow:function(e,o){t.datagrid("selectRow",e),a(o)}})});