$(function(){function t(t){var i=$("#sc_nomenu");switch(i.is(":visible")&&i.hide(),$(".temp-setlist-tab").removeClass("temp-d-active"),$("#sc_"+t).addClass("temp-d-active"),t){case"currency":e();break;case"bid_type":a();break;case"estimate":n();break;case"statement":p(),o()}}function e(){$.ajax({type:"POST",url:BiddingPHP.getDefaultCurrency,dataType:"json",beforeSend:function(){$("#sc_currency").append(Strack.loading_dom("white","","lbid"))},success:function(t){var e="";200==parseInt(t.status)&&(e=t.currency_id),$("#default_currency").combobox({url:BiddingPHP.getCurrencyList,width:360,height:25,value:e,valueField:"currency_id",textField:"currency_name",onSelect:function(t){i(t.currency_id)}}),$("#st-load_lbid").remove()}})}function i(t){$.ajax({type:"POST",url:BiddingPHP.modifyDefaultCurrency,dataType:"json",data:{currency_id:t},success:function(t){200==parseInt(t.status)?Strack.top_message({bg:"g",msg:t.message}):layer.msg(t.message,{icon:7,time:1200,anim:6})}})}function a(){var t=$("#bid_type_grid");t.hasClass("grid_active")?$("#data_bid_type").datagrid("reload"):(t.addClass("grid_active"),$("#data_bid_type").datagrid({url:BiddingPHP.getBidTypeData,rownumbers:!0,nowrap:!0,height:Strack.panel_height("#sc_bid_type",38),adaptive:{dom:"#sc_bid_type",exth:38},columns:[[{field:"bid_opt_id",align:"center",checkbox:!0},{field:"name",title:BiddingPHP.Pend_Bidding_Type,align:"center",width:260},{field:"user_name",title:StrackPHP.Created_by,align:"center",width:220}]],pagination:!0,toolbar:"#tb",pageSize:100,pageList:[100,200],pageNumber:1,pagePosition:"bottom",remoteSort:!1,onDblClickRow:function(t,e){$(this).datagrid("selectRow",t),d(e,"data_bid_type")}}))}function d(t,e){Strack.open_dialog("dialog",{title:BiddingPHP.Modify_BidType_Title,width:480,height:220,content:Strack.dialog_dom({type:"normal",hidden:[{case:101,id:"Mbid_type",type:"hidden",name:"bid_type",valid:1,value:60},{case:101,id:"Mbid_opt_id",type:"hidden",name:"bid_opt_id",valid:1,value:t.bid_opt_id}],items:[{case:1,id:"Mbid_name",type:"text",lang:BiddingPHP.Pend_Bidding_Type,name:"bid_name",valid:"1,128",value:t.name}],footer:[{obj:"modify_bidtype_submit",type:1,title:StrackPHP.Submit},{obj:"dialog_cancel",type:8,title:StrackPHP.Cancel}]}),close:function(){$("#"+e).datagrid("reload")}})}function n(){var t=$("#est_grid");t.hasClass("grid_active")?$("#data_estimate").datagrid("reload"):(t.addClass("grid_active"),$("#data_estimate").datagrid({url:BiddingPHP.getEstimateData,rownumbers:!0,nowrap:!0,height:Strack.panel_height("#sc_estimate",0),adaptive:{dom:"#sc_estimate",exth:38},columns:[[{field:"bid_opt_id",align:"center",checkbox:!0},{field:"name",title:BiddingPHP.Bid_Item_Name,align:"center",width:260},{field:"item_type",title:BiddingPHP.Bid_Item_Type,align:"center",width:260},{field:"item_cost",title:BiddingPHP.Bid_Item_Cost,align:"center",width:160},{field:"description",title:StrackPHP.Description,align:"center",width:380},{field:"user_name",title:StrackPHP.Created_by,align:"center",width:220}]],pagination:!0,pageSize:100,pageList:[100,200],pageNumber:1,pagePosition:"bottom",remoteSort:!1,onDblClickRow:function(t,e){$(this).datagrid("selectRow",t),s(e,"data_estimate")}}))}function s(t,e){Strack.open_dialog("dialog",{title:BiddingPHP.Modify_Estimate_Title,width:480,height:360,content:Strack.dialog_dom({type:"normal",hidden:[{case:101,id:"Mbid_type",type:"hidden",name:"bid_type",valid:1,value:20},{case:101,id:"Mbid_opt_id",type:"hidden",name:"bid_opt_id",valid:1,value:t.bid_opt_id}],items:[{case:1,id:"Mest_name",type:"text",lang:BiddingPHP.Bid_Item_Name,name:"name",valid:"1,128",value:t.name},{case:1,id:"Mest_desc",type:"text",lang:StrackPHP.Description,name:"est_desc",valid:"",value:t.description},{case:2,id:"Mest_type",type:"text",lang:BiddingPHP.Bid_Item_Type,name:"est_type",valid:1,value:t.item_typeid},{case:1,id:"Mest_cost",type:"text",lang:BiddingPHP.Bid_Item_Cost,name:"est_cost",valid:"0,8",value:t.item_cost}],footer:[{obj:"update_estimate",type:1,title:StrackPHP.Submit},{obj:"dialog_cancel",type:8,title:StrackPHP.Cancel}]}),inits:function(){Strack.combobox_widget(2,"#Mest_type",Strack.JsonEstimateType(),"type_id","type_name",parseInt(t.item_typeid))},close:function(){$("#"+e).datagrid("reload")}})}function o(t,e,i,a){$.ajax({type:"POST",url:BiddingPHP.loadStatementList,dataType:"json",beforeSend:function(){$("#sc_statement").append(Strack.loading_dom("white","","lbid"))},success:function(t){var e="";t.forEach(function(t){e+=_(t,"")}),c(e),$("#st-load_lbid").remove()}})}function c(t){t||(t=m(BiddingPHP.Statement_List_Null)),$("#bid_stalist").empty().append(t)}function l(t){var e=$(".adbid-sta-item");if(0==parseInt(e.length))switch(t){case"statement":$("#bid_stalist").empty().append(m(BiddingPHP.Statement_List_Null));break;case"assum":$("#bid_assum").empty().append(m(BiddingPHP.AssumptionsListNull));break;case"terms":$("#bid_terms").empty().append(m(BiddingPHP.TermsListNull))}}function m(t){var e="";return e+='<div class="bid-list-null">'+t+"</div>"}function _(t,e){var i="";return i+='<a href="javascript:;" id="staid_'+t.bid_opt_id+'" class="adbid-sta-item '+e+'" onclick="obj.select_staItem(this)" data-bidid="'+t.bid_opt_id+'" data-bidname="'+t.name+'" data-bidtype="10">'+t.name+"</a>"}function r(t){var e=$("#bid_staeditor").height(),i="";$("#bid_editor_sta").css("height",e-9),g(),u=new wangEditor("bid_editor_sta"),u.config.menus=b,u.create(),i=t||"<p>"+BiddingPHP.Enter_the_Content+"</p>",u.$txt.html(i)}function g(){$("#bid_staeditor").on("mresize",function(){var t=$("#bid_staeditor").height();$("#bid_editor_sta").css("height",t-41)})}function p(){var t=$("#bid_staeditor");t.hasClass("editor_active")&&t.hide()}obj={switch_bid_menu:function(e){var i=$(e).data("tab");$(".templates-items").removeClass("templates-active"),$(e).parent().addClass("templates-active"),t(i)},add_statement:function(){Strack.open_dialog("dialog",{title:BiddingPHP.Add_Statement_title,width:480,height:180,content:Strack.dialog_dom({type:"normal",hidden:[{case:101,id:"Mbid_type",type:"hidden",name:"bid_type",valid:1,value:10}],items:[{case:1,id:"Msta_name",type:"text",lang:StrackPHP.Name,name:"sta_name",valid:"1,128",value:""}],footer:[{obj:"add_statement_submit",type:1,title:StrackPHP.Submit},{obj:"dialog_cancel",type:8,title:StrackPHP.Cancel}]})})},add_statement_submit:function(){Strack.ajax_dialog_form("#st_dialog_form input","",BiddingPHP.addStatement,{back:function(t){if(200==parseInt(t.status)){Strack.dialog_cancel(),Strack.top_message({bg:"g",msg:t.message}),$("#bid_stalist").prepend(_(t.data,"admin-bid-ac"));var e=$("#bid_staeditor");e.hasClass("editor_active")?u.$txt.html("<p>"+BiddingPHP.Enter_the_Content+"</p>"):(e.addClass("editor_active"),r());var i=$(".bid-list-null");i.is(":visible")&&i.hide()}else layer.msg(t.message,{icon:7,time:1200,anim:6})}})},save_statement:function(){var t=$(".admin-bid-ac");if(t.length>0){var e=u.$txt.html(),i=t.data("bidid"),a=$("#sc_statement");$.ajax({type:"POST",url:BiddingPHP.saveBiddingContent,dataType:"json",data:{sta_id:i,sta_content:e},beforeSend:function(){a.append(Strack.loading_dom("white","","lbid"))},success:function(t){$("#st-load_lbid").remove(),200==parseInt(t.status)&&Strack.top_message({bg:"g",msg:t.message})}})}else layer.msg(BiddingPHP.SelectStatementNull,{icon:2,time:1200,anim:6})},modify_statement:function(){var t=$(".admin-bid-ac");if(t.length>0){var e=t.attr("data-bidid"),i=t.attr("data-bidname");Strack.open_dialog("dialog",{title:BiddingPHP.Modify_Statement_Name,width:480,height:180,content:Strack.dialog_dom({type:"normal",hidden:[{case:101,id:"Mbid_type",type:"hidden",name:"bid_type",valid:1,value:10},{case:101,id:"Msta_id",type:"hidden",name:"sta_id",valid:1,value:e}],items:[{case:1,id:"Msta_name",type:"text",lang:StrackPHP.Name,name:"sta_name",valid:"1,128",value:i}],footer:[{obj:"modify_statement_up",type:1,title:StrackPHP.Submit},{obj:"dialog_cancel",type:8,title:StrackPHP.Cancel}]})})}else layer.msg(BiddingPHP.SelectStatementNull,{icon:2,time:1200,anim:6})},modify_statement_up:function(){Strack.ajax_dialog_form("#st_dialog_form input","",BiddingPHP.modifyStatementName,{back:function(t){200==parseInt(t.status)?(Strack.dialog_cancel(),Strack.top_message({bg:"g",msg:t.message}),$(".admin-bid-ac").html(t.data.name).attr("data-bidname",t.data.name)):layer.msg(t.message,{icon:7,time:1200,anim:6})}})},delete_statement:function(){var t=$(".admin-bid-ac");if(t.length>0){var e=t.data("bidid"),i=$("#sc_statement");$.messager.confirm(StrackPHP.Confirmation_Box,BiddingPHP.Delete_Statement_Notice,function(t){t&&$.ajax({type:"POST",url:BiddingPHP.deleteStatement,dataType:"json",data:{primary_ids:e},beforeSend:function(){i.append(Strack.loading_dom("white","","lbid"))},success:function(t){$("#staid_"+e).remove(),$("#st-load_lbid").remove(),p(),l("statement"),Strack.top_message({bg:"g",msg:t.message})}})})}else layer.msg(BiddingPHP.SelectStatementNull,{icon:2,time:1200,anim:6})},select_staItem:function(t){$(".adbid-sta-item").removeClass("admin-bid-ac"),$(t).addClass("admin-bid-ac");var e=$(t).data("bidid"),i=$("#bid_staeditor");$.ajax({type:"POST",url:BiddingPHP.getBiddingContent,dataType:"json",data:{sta_id:e},beforeSend:function(){i.append(Strack.loading_dom("white","","lbid"))},success:function(t){if(i.hasClass("editor_active")){i.show();var e="";e=t.content?t.content:"<p>"+BiddingPHP.Enter_the_Content+"</p>",u.$txt.html(e)}else i.addClass("editor_active"),r(t.content);$("#st-load_lbid").remove()}})},add_estimate:function(){Strack.open_dialog("dialog",{title:BiddingPHP.Add_Estimate_Title,width:480,height:360,content:Strack.dialog_dom({type:"normal",hidden:[{case:101,id:"Mbid_type",type:"hidden",name:"bid_type",valid:1,value:20}],items:[{case:1,id:"Mest_name",type:"text",lang:BiddingPHP.Bid_Item_Name,name:"name",valid:"1,128",value:""},{case:1,id:"Mest_desc",type:"text",lang:StrackPHP.Description,name:"est_desc",valid:"",value:""},{case:2,id:"Mest_type",type:"text",lang:BiddingPHP.Bid_Item_Type,name:"est_type",valid:1,value:""},{case:1,id:"Mest_cost",type:"text",lang:BiddingPHP.Bid_Item_Cost,name:"est_cost",valid:"0,8",value:""}],footer:[{obj:"add_estimate_submit",type:1,title:StrackPHP.Submit},{obj:"dialog_cancel",type:8,title:StrackPHP.Cancel}]}),inits:function(){Strack.combobox_widget(2,"#Mest_type",Strack.JsonEstimateType(),"type_id","type_name",10)},close:function(){$("#data_estimate").datagrid("reload")}})},add_estimate_submit:function(){Strack.ajax_dialog_form("#st_dialog_form input","",BiddingPHP.addEstimate,{back:function(t){200==parseInt(t.status)?(Strack.dialog_cancel(),Strack.top_message({bg:"g",msg:t.message})):layer.msg(t.message,{icon:7,time:1200,anim:6})}})},modify_estimate:function(){var t=$("#data_estimate").datagrid("getSelections");t.length<1?layer.msg(StrackPHP.Please_Select_One,{icon:2,time:1200,anim:6}):t.length>1?layer.msg(StrackPHP.Only_Choose_One,{icon:2,time:1200,anim:6}):s(t[0],"data_estimate")},update_estimate:function(){Strack.ajax_dialog_form("#st_dialog_form input","",BiddingPHP.modifyEstimate,{back:function(t){200==parseInt(t.status)?(Strack.dialog_cancel(),Strack.top_message({bg:"g",msg:t.message})):layer.msg(t.message,{icon:7,time:1200,anim:6})}})},delete_estimate:function(){Strack.ajax_grid_delete("data_estimate","bid_opt_id",BiddingPHP.Delete_Estimate_Notice,BiddingPHP.deleteEstimate)},add_bidtype:function(){Strack.open_dialog("dialog",{title:BiddingPHP.Add_BidType_Title,width:480,height:220,content:Strack.dialog_dom({type:"normal",hidden:[{case:101,id:"Mbid_type",type:"hidden",name:"bid_type",valid:1,value:60}],items:[{case:1,id:"Mbid_name",type:"text",lang:BiddingPHP.Pend_Bidding_Type,name:"bid_name",valid:"1,128",value:""}],footer:[{obj:"add_bidtype_submit",type:1,title:StrackPHP.Submit},{obj:"dialog_cancel",type:8,title:StrackPHP.Cancel}]}),close:function(){$("#data_bid_type").datagrid("reload")}})},add_bidtype_submit:function(){Strack.ajax_dialog_form("#st_dialog_form input","",BiddingPHP.addBidType,{back:function(t){200==parseInt(t.status)?(Strack.dialog_cancel(),Strack.top_message({bg:"g",msg:t.message})):layer.msg(t.message,{icon:7,time:1200,anim:6})}})},modify_bidtype:function(){var t=$("#data_bid_type").datagrid("getSelections");t.length<1?layer.msg(StrackPHP.Please_Select_One,{icon:2,time:1200,anim:6}):t.length>1?layer.msg(StrackPHP.Only_Choose_One,{icon:2,time:1200,anim:6}):d(t[0],"data_bid_type")},modify_bidtype_submit:function(){Strack.ajax_dialog_form("#st_dialog_form input","",BiddingPHP.modifyBidtype,{back:function(t){200==parseInt(t.status)?(Strack.dialog_cancel(),Strack.top_message({bg:"g",msg:t.message})):layer.msg(t.message,{icon:7,time:1200,anim:6})}})},delete_bidtype:function(){Strack.ajax_grid_delete("data_bid_type","bid_opt_id",BiddingPHP.Delete_BidType_notice,BiddingPHP.deleteBidType)}};var u,b=["source","|","bold","underline","italic","strikethrough","eraser","forecolor","bgcolor","|","quote","fontfamily","fontsize","head","unorderlist","orderlist","alignleft","aligncenter","alignright","|","link","unlink","table","|","undo","redo","fullscreen"]});