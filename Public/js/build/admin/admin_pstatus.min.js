$(function(){obj={status_add:function(){var t=$("input[name=status-name]").val(),a=$("input[name=status-color]").val(),s=Strack.get_combos_val("#status-corresponds","combobox","getValue"),o=Strack.get_combos_val("#status-group","combobox","getValues"),e=Strack.get_combos_val("#status-icon","combobox","getValue");o.length>0&&(o=o.join(",")),t.length<1?$.messager.alert(StrackPHP.Notice,StatusPHP.StaName_Null,"info"):6!=a.length?$.messager.alert(StrackPHP.Notice,StatusPHP.StaColor_Null,"info"):e.length<1?$.messager.alert(StrackPHP.Notice,StatusPHP.StaIcon_Null,"info"):s.length<1?$.messager.alert(StrackPHP.Notice,StatusPHP.StaCponds_Null,"info"):$.ajax({type:"POST",url:StatusPHP.AddStatus,data:{status_name:t,status_color:a,status_icon:e,corresponds:s,group_id:o},beforeSend:function(){$.messager.progress({title:StrackPHP.Waiting,msg:StrackPHP.loading})},success:function(t){$.messager.progress("close"),-1==t?$.messager.alert(StrackPHP.Warning,StatusPHP.StaName_CF,"warning"):-2==t?$.messager.alert(StrackPHP.Warning,StatusPHP.StaName_Null,"warning"):-3==t?$.messager.alert(StrackPHP.Warning,StatusPHP.StaColor_Only,"warning"):($("input[name=status-name]").val(""),$("input[name=status-color]").val(""),Strack.top_message({bg:"g",msg:StatusPHP.AddStatusSC}),$("#status-corresponds").combobox("setValue",20),$("#status-group").combobox("setValue",""),$("#datagrid_box").datagrid("reload"))}})},status_modify:function(){var t=a.datagrid("getSelections");if(t.length<1)$.messager.alert(StrackPHP.Notice,StrackPHP.Please_Select_One,"info");else if(t.length>1)$.messager.alert(StrackPHP.Notice,StrackPHP.Only_Choose_One,"info");else{var s=t[0];Strack.open_dialog("dialog",{title:StatusPHP.StaModify,width:480,height:420,content:Strack.dialog_dom({type:1,hidden:[{case:101,id:"Mstatus_id",type:"hidden",name:"status_id",valid:1,value:s.status_id}],items:[{case:1,id:"Mstatus_name",type:"text",lang:StrackPHP.Name,name:"status_name",valid:1,value:s.status_name},{case:2,id:"Mstatus_color",lang:StrackPHP.Color,name:"status_color",valid:7},{case:2,id:"Mstatus_Icon",lang:StrackPHP.Icon,name:"status_icon",valid:1},{case:2,id:"Mstatus_Cponds",lang:StatusPHP.Corresponds,name:"corresponds",valid:1},{case:2,id:"Mstatus_Group",lang:StatusPHP.Group,name:"group_id",valid:0}],footer:[{obj:"status_update",type:1,title:StrackPHP.Update},{obj:"status_cancel",type:2,title:StrackPHP.Cancel}]}),inits:function(){Strack.color_pick_widget("#Mstatus_color","hex","light",s.status_color,320),Strack.combobox_widget(4,"#Mstatus_Icon",Strack.JsonStatusIcon(),"icon","icon",s.status_icon),Strack.combobox_widget(2,"#Mstatus_Cponds",Strack.JsonCorresponds(),"id","name",s.correspond),Strack.combobox_widget(3,"#Mstatus_Group",StatusPHP.StaGroup,"group_id","title",s.group_id)},close:function(){a.datagrid("unselectAll")}})}},status_update:function(){Strack.ajax_dialog_form("#st_dialog_form input",t,StatusPHP.MDStatus,{back:function(t){-1==t?$.messager.alert(StrackPHP.Warning,StatusPHP.StaName_CF,"warning"):-2==t?$.messager.alert(StrackPHP.Warning,StatusPHP.StaName_Null,"warning"):-3==t?$.messager.alert(StrackPHP.Warning,StatusPHP.StaColor_Only,"warning"):(Strack.top_message({bg:"g",msg:StatusPHP.MDStatusSC}),$("#dialog").dialog("close"),$("#datagrid_box").datagrid("reload"))}})},status_delete:function(){for(var t=a.datagrid("getSelections"),s=[],o=0;o<t.length;o++)s.push(t[o].status_id);Strack.ajax_grid_delete(t,StatusPHP.Destatus_notice,StatusPHP.DEStatus,{status_ids:s.join(",")},"",StatusPHP.DEStatusSC)},status_cancel:function(){$("#dialog").dialog("close")}},Strack.color_pick_widget("#picker","hex","light"),Strack.combobox_widget(4,"#status-icon",StrackPHP.getIconList,"icon","icon","",300,30),Strack.combobox_widget(1,"#status-corresponds",StrackPHP.getStatusCorresponds,"id","name",20,300,30),Strack.combobox_widget(3,"#status-group",StatusPHP.StaGroup,"group_id","title","",300,30);var t={};t["status_name-1"]=StatusPHP.StaName_Null,t["status_color-1"]=StatusPHP.StaColor_Null,t["status_icon-1"]=StatusPHP.StaIcon_Null,t["corresponds-1"]=StatusPHP.StaCponds_Null;var a=$("#datagrid_box").datagrid({url:StatusPHP.DataStatus,rownumbers:!0,nowrap:!0,fitColumns:Strack.FitColumns(".admin-dept-right",1004),height:Strack.panel_height(".admin-dept-right",0),adaptive:{dom:".admin-dept-right",min_width:1004},columns:[[{field:"status_id",align:"center",checkbox:!0},{field:"status_icon",title:StrackPHP.Icon,align:"center",width:50,formatter:function(t,a,s){return'<i class="'+t+'" style="color: #'+a.status_color+'"></i>'}},{field:"status_color",title:StrackPHP.Color,align:"center",width:136,formatter:function(t,a,s){return'<div class="picker-color" style="background-color: #'+t+'">#'+t+"</div>"}},{field:"status_name",title:StrackPHP.Name,align:"center",width:260},{field:"correspond",title:StatusPHP.Corresponds,align:"center",width:260,formatter:function(t,a,s){return Strack.DeCorresponds(t)}},{field:"group_name",title:StatusPHP.Group,align:"center",width:220}]],toolbar:"#tb",pagination:!0,pageSize:25,pageList:[25,50],pageNumber:1,pagePosition:"bottom",remoteSort:!1,onDblClickRow:function(t,s){a.datagrid("selectRow",t),Strack.open_dialog("dialog",{title:StatusPHP.StaModify,width:480,height:420,content:Strack.dialog_dom({type:1,hidden:[{case:101,id:"Mstatus_id",type:"hidden",name:"status_id",valid:1,value:s.status_id}],items:[{case:1,id:"Mstatus_name",type:"text",lang:StrackPHP.Name,name:"status_name",valid:1,value:s.status_name},{case:2,id:"Mstatus_color",lang:StrackPHP.Color,name:"status_color",valid:7},{case:2,id:"Mstatus_Icon",lang:StrackPHP.Icon,name:"status_icon",valid:1},{case:2,id:"Mstatus_Cponds",lang:StatusPHP.Corresponds,name:"corresponds",valid:1},{case:2,id:"Mstatus_Group",lang:StatusPHP.Group,name:"group_id",valid:0}],footer:[{obj:"status_update",type:1,title:StrackPHP.Update},{obj:"dialog_cancel",type:8,title:StrackPHP.Cancel}]}),inits:function(){Strack.color_pick_widget("#Mstatus_color","hex","light",s.status_color,320),Strack.combobox_widget(4,"#Mstatus_Icon",Strack.JsonStatusIcon(),"icon","icon",s.status_icon),Strack.combobox_widget(2,"#Mstatus_Cponds",Strack.JsonCorresponds(),"id","name",s.correspond),Strack.combobox_widget(3,"#Mstatus_Group",StatusPHP.StaGroup,"group_id","title",s.group_id)},close:function(){a.datagrid("unselectRow",t)}})}})});