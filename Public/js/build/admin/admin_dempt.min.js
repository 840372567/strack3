$(function(){obj={dept_add:function(){var e=$("input[name=dept-name]").val(),t=Strack.get_combos_val("#relate_scope","combobox","getValue");e.length<1?layer.msg(DeptPHP.AddNotice,{icon:2,time:1200,anim:6}):t.length<1?layer.msg(DeptPHP.Relate_scope_Null,{icon:2,time:1200,anim:6}):$.ajax({type:"POST",url:DeptPHP.AddDept,data:{dept_name:e,scope_id:t},beforeSend:function(){$.messager.progress({title:StrackPHP.Waiting,msg:StrackPHP.loading})},success:function(e){$.messager.progress("close"),-1==e?layer.msg(DeptPHP.Add_CF_Dept,{icon:7,time:1200,anim:6}):-2==e?layer.msg(DeptPHP.Add_NULL_Dept,{icon:7,time:1200,anim:6}):(Strack.top_message({bg:"g",msg:DeptPHP.AddDeparmentSC}),$("input[name=dept-name]").val(""),$("#datagrid_box").datagrid("reload"))}})},dept_modify:function(){var e=t.datagrid("getSelections");if(e.length<1)layer.msg(StrackPHP.Please_Select_One,{icon:2,time:1200,anim:6});else if(e.length>1)layer.msg(StrackPHP.Only_Choose_One,{icon:2,time:1200,anim:6});else{var i=e[0];Strack.open_dialog("dialog",{title:DeptPHP.Dept_Title,width:480,height:240,content:Strack.dialog_dom({type:1,hidden:[{case:101,id:"Mdept_id",type:"hidden",name:"dept_id",valid:1,value:i.dept_id}],items:[{case:1,id:"Mdept_name",type:"text",lang:StrackPHP.Name,name:"dept_name",valid:1,value:i.dept_name},{case:2,id:"Mscope_id",lang:DeptPHP.Re_Scope,name:"scope_id",valid:1}],footer:[{obj:"dept_update",type:1,title:StrackPHP.Update},{obj:"dept_cancel",type:2,title:StrackPHP.Cancel}]}),inits:function(){Strack.combobox_widget(1,"#Mscope_id",DeptPHP.ScopeList,"scope_id","scope_name",i.scope_id,380)},close:function(){$("#datagrid_box").datagrid("unselectAll")}})}},dept_update:function(){Strack.ajax_dialog_form("#st_dialog_form input",e,DeptPHP.MDDept,{back:function(e){-1==e?layer.msg(DeptPHP.Add_CF_Dept,{icon:7,time:1200,anim:6}):-2==e?layer.msg(DeptPHP.Add_NULL_Dept,{icon:7,time:1200,anim:6}):-3==e?layer.msg(StrackPHP.Illegal_Operation,{icon:7,time:1200,anim:6}):(Strack.top_message({bg:"g",msg:DeptPHP.MDDeparmentSC}),$("#dialog").dialog("close"),$("#datagrid_box").datagrid("reload"))}})},dept_delete:function(){for(var e=t.datagrid("getSelections"),i=[],a=0;a<e.length;a++)i.push(e[a].dept_id);Strack.ajax_grid_delete(e,DeptPHP.De_dept_notice,DeptPHP.DEDept,{dept_ids:i.join(",")},"",DeptPHP.DEDeparmentSC)},dept_cancel:function(){$("#dialog").dialog("close")}},Strack.combobox_widget(1,"#relate_scope",DeptPHP.ScopeList,"scope_id","scope_name","",300,30);var e=new Array;e["dept_name-1"]=DeptPHP.AddNotice,e["scope_id-1"]=DeptPHP.Relate_scope_Null;var t=$("#datagrid_box").datagrid({url:DeptPHP.DataDept,rownumbers:!0,nowrap:!0,fitColumns:Strack.FitColumns(".admin-dept-right",300),height:Strack.panel_height(".admin-dept-right",0),adaptive:{dom:".admin-dept-right",min_width:300},columns:[[{field:"dept_id",align:"center",checkbox:!0},{field:"dept_name",title:DeptPHP.Item_Deptname,align:"center",width:300},{field:"scope_name",title:DeptPHP.Re_Scope,align:"center",width:300,sortable:!0}]],toolbar:"#tb",pagination:!0,pageSize:25,pageList:[25,50],pageNumber:1,pagePosition:"bottom",remoteSort:!1,onDblClickRow:function(e,i){t.datagrid("selectRow",e),Strack.open_dialog("dialog",{title:DeptPHP.Dept_Title,width:480,height:240,content:Strack.dialog_dom({type:1,hidden:[{case:101,id:"Mdept_id",type:"hidden",name:"dept_id",valid:1,value:i.dept_id}],items:[{case:1,id:"Mdept_name",type:"text",lang:StrackPHP.Name,name:"dept_name",valid:1,value:i.dept_name},{case:2,id:"Mscope_id",lang:DeptPHP.Re_Scope,name:"scope_id",valid:1}],footer:[{obj:"dept_update",type:1,title:StrackPHP.Update},{obj:"dept_cancel",type:2,title:StrackPHP.Cancel}]}),inits:function(){Strack.combobox_widget(1,"#Mscope_id",DeptPHP.ScopeList,"scope_id","scope_name",i.scope_id,380)},close:function(){t.datagrid("unselectRow",e)}})}})});