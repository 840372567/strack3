$(function(){function e(t,a){Strack.open_dialog("dialog",{title:AuthPHP.Auth_Modify_Title,width:480,height:360,content:Strack.dialog_dom({type:"normal",hidden:[{case:101,id:"Mauth_id",type:"hidden",name:"auth_rule_id",valid:1,value:t.auth_rule_id}],items:[{case:2,id:"Mauth_category",lang:StrackPHP.Category,name:"category",valid:1},{case:1,id:"Mauth_name",type:"text",lang:StrackPHP.Name,name:"name",valid:"1,128",value:t.name},{case:1,id:"Mauth_alias",type:"text",lang:StrackPHP.Alias,name:"alias",valid:"1,128",value:t.alias},{case:1,id:"Mauth_method",type:"text",lang:AuthPHP.Auth_Method,name:"method",valid:3,value:t.method}],footer:[{obj:"auth_update",type:1,title:StrackPHP.Update},{obj:"dialog_cancel",type:8,title:StrackPHP.Cancel}]}),inits:function(){Strack.combobox_widget("#Mauth_category",{url:AuthPHP.getDateboxType,valueField:"category_id",textField:"category_name",value:t.category})},close:function(){$("#"+a).datagrid("reload")}})}obj={auth_add:function(){var t=Strack.validate_form("add_auth");200==t.status&&$.ajax({type:"POST",url:AuthPHP.addAuth,data:t.data,dataType:"json",beforeSend:function(){$.messager.progress({title:StrackPHP.Waiting,msg:StrackPHP.loading})},success:function(t){$.messager.progress("close"),200==parseInt(t.status)?(Strack.top_message({bg:"g",msg:t.message}),obj.auth_reset()):layer.msg(t.message,{icon:7,time:1200,anim:6})}})},auth_modify:function(){var t=$("#datagrid_box").datagrid("getSelections");t.length<1?layer.msg(StrackPHP.Please_Select_One,{icon:2,time:1200,anim:6}):1<t.length?layer.msg(StrackPHP.Only_Choose_One,{icon:2,time:1200,anim:6}):e(t[0],"datagrid_box")},auth_update:function(){Strack.ajax_dialog_form("#st_dialog_form .dialog-widget-val","",AuthPHP.modifyAuth,{back:function(t){200==parseInt(t.status)?(Strack.dialog_cancel(),Strack.top_message({bg:"g",msg:t.message})):layer.msg(t.message,{icon:7,time:1200,anim:6})}})},auth_delete:function(){Strack.ajax_grid_delete("datagrid_box","auth_rule_id",AuthPHP.Auth_Delete_Confirm,AuthPHP.deleteAuth)},auth_reset:function(){$("#datagrid_box").datagrid("reload")}},Strack.combobox_widget("#auth_category",{url:AuthPHP.getAuthCategory,valueField:"category_id",textField:"category_name",width:300,height:28}),$("#datagrid_box").datagrid({url:AuthPHP.getAuthData,rownumbers:!0,nowrap:!0,DragSelect:!0,height:Strack.panel_height(".admin-dept-right",0),adaptive:{dom:".admin-dept-right",min_width:740,exth:0},columns:[[{field:"auth_rule_id",align:"center",checkbox:!0},{field:"name",title:StrackPHP.Name,width:160,align:"center"},{field:"alias",title:StrackPHP.Alias,width:160,align:"center"},{field:"category",title:StrackPHP.Category,width:160,align:"center"},{field:"method",title:AuthPHP.Auth_Method,width:460,align:"center"}]],toolbar:"#tb",pagination:!0,pageSize:500,pageList:[500,1e3],pageNumber:1,pagePosition:"bottom",onDblClickRow:function(t,a){$(this).datagrid("selectRow",t),e(a,"datagrid_box")}})});