$(function(){function e(e){switch(e){case"yes":return!0;case"no":return!1}}function t(e,t){var i=t?"yes":"no";$.ajax({type:"POST",url:NoticePHP.upReminderSetting,data:{setField:e,setVal:i},dataType:"json",success:function(e){Strack.top_message({bg:"g",msg:NoticePHP.Account_Reminder_Save_SC})}})}obj={setAdProjStatus:function(){var e=$("#project_list").combobox("getValue");if(e>0){var t=$("#pstatus_set").datagrid("getData");$.ajax({type:"POST",url:NoticePHP.setAdProjStatus,dataType:"json",data:{project_id:e,setData:JSON.stringify(t.rows)},success:function(e){Strack.top_message({bg:"g",msg:NoticePHP.Save_Status_Reminder_SC}),$("#pstatus_set").datagrid("reload")}})}else layer.msg(NoticePHP.Project_None_Warning,{icon:2,time:1200,anim:6})},change_field_col:function(e){$(".iex_text").on("blur",function(){var t=$(this).attr("data-index"),i=$("#"+e).datagrid("selectRow",t).datagrid("getSelected"),a=$(this).closest("td").attr("field"),n="";n=$(this).is(":checked")?"yes":"no",i[a]=n,$("#"+e).datagrid("updateRow",{index:t,row:i}),$(".iex_text").off("blur"),obj.change_field_col(e)})}},function(){var i=$("#pstatus_set");$.ajax({type:"POST",url:NoticePHP.getReminderSetting,dataType:"json",beforeSend:function(){$("#active-notice").append(Strack.loading_dom("white","","reminder"))},success:function(a){$("#st-load_reminder").remove(),$("#msg_open").switchbutton({width:88,checked:e(a.open_reminder),onChange:function(e){t("open_reminder",e)}}),$("#msg_sendim").switchbutton({width:88,checked:e(a.send_reminder_im),onChange:function(e){t("send_reminder_im",e)}}),$("#project_list").combobox({url:NoticePHP.loadAllProject,width:270,height:30,valueField:"project_id",textField:"p_name",prompt:NoticePHP.Select_Project,onSelect:function(e){i.datagrid("reload",{project_id:e.project_id,model:"admin"})}}),i.datagrid({url:NoticePHP.projStaReminder,width:760,height:360,rowheight:30,DragSelect:!0,queryParams:{project_id:0,model:"admin"},columns:[[{field:"status_id",checkbox:!0},{field:"status_name",title:StrackPHP.Status,width:260,align:"center"},{field:"status_sys",title:NoticePHP.System_Reminder,width:180,align:"center",formatter:function(t,i,a){return'<input class="iex_text" type="checkbox"  '+(e(t)?'checked = "checked"':"")+' data-index="'+a+'">'}},{field:"status_mail",title:NoticePHP.Mail_Reminder,width:180,align:"center",formatter:function(t,i,a){return'<input class="iex_text" type="checkbox" '+(e(t)?'checked = "checked"':"")+' data-index="'+a+'">'}}]],toolbar:"#tb_list",onLoadSuccess:function(e){obj.change_field_col("pstatus_set")}})}})}()});