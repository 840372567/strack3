$(function(){function t(i,s,o){$.ajax({type:"POST",url:ReportPHP.loadReportPlist,dataType:"json",data:{pageNum:i,pageSize:s},beforeSend:function(){"new"==o&&$("#projc_list").append(Strack.loading_dom("white","","reports"))},success:function(r){var c=ReportPHP.reportDetail.replace(".html",""),n=r.total;r.data.forEach(function(t){$("#projc_list").append(a(t,c)),$("#projc_progress_"+t.project_id).progress({}),e(t.project_id,t.chart)}),"new"==o&&($("#projc_list").on("scroll",function(){if((this.scrollTop||this.scrollTop)==(this.scrollHeight||this.scrollHeight)-(this.clientHeight||this.clientHeight)){i++;var e=Math.ceil(n/s);i<=e&&t(i,s,"more")}}),$("#st-load_reports").remove())}})}function i(t,i){return{title:{text:t,textStyle:{fontSize:"12",fontWeight:100},x:"center",y:"center"},tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c} ({d}%)"},series:[{name:StrackPHP.Status,type:"pie",radius:["50%","70%"],avoidLabelOverlap:!1,label:{normal:{show:!1,position:"center"},emphasis:{show:!1,textStyle:{fontSize:"12",fontWeight:"bold"}}},labelLine:{normal:{show:!1}},data:i}]}}function s(t,s){var e=[];for(var a in s)e.push({value:s[a],name:a});return 0==e.length&&e.push({value:0,name:"none"}),i(t,e)}function e(t,i){var e="epis_chart_"+t,a="seq_chart_"+t,o="pred_chart_"+t,r="asset_chart_"+t,c="shot_chart_"+t;echarts.init(document.getElementById(e),"walden").setOption(s(StrackPHP.Episodes,i.epis_chart)),echarts.init(document.getElementById(a),"walden").setOption(s(StrackPHP.Sequences,i.seqs_chart)),echarts.init(document.getElementById(o),"walden").setOption(s(StrackPHP.PreProduction,i.prod_chart)),echarts.init(document.getElementById(r),"walden").setOption(s(StrackPHP.Assets,i.asset_chart)),echarts.init(document.getElementById(c),"walden").setOption(s(StrackPHP.Shots,i.shot_chart))}function a(t,i){var s={thumb_arr:{}};return s.thumb_arr.p_folder=t.p_folder,s.thumb_arr.p_thumb=t.p_thumb,'<div class="proj-item"><div class="proj-count-main"><div class="proj-c-left aign-left"><a href="'+i+"/"+t.project_id+'.html" class="projc-detail aign-left"><div class="proj-item-image">'+Strack.build_thumb_dom(t.p_thumb,s,"max")+'</div><div class="projc-title"><div class="projc-title-h"><div class="projc-info-name text-ellipsis aign-left"><i class="icon-uniE60E2 icon-left"></i>'+t.p_name+'</div></div></div></a><div class="projc-number aign-left"><div class="projc-remain">'+t.remain+'</div><div class="projc-remain-b"><div class="col-lg-4 no-box-sizing projc-border-l"><p class="text-sm mar-no"><i class="icon-uniF1E9 icon-left"></i>'+StrackPHP.PreProduction+'</p><div class="text-sm">'+t.prod_number+'</div></div><div class="col-lg-4 no-box-sizing projc-border-l"><p class="text-sm mar-no"><i class="icon-small_assets icon-left"><span class="path1"></span><span class="path2"></span><span class="path3"></span><span class="path4"></span></i>'+StrackPHP.Assets+'</p><div class="text-sm">'+t.asset_number+'</div></div><div class="col-lg-4 no-box-sizing projc-border-l projc-border-r"><p class="text-sm mar-no"><i class="icon-icon_shots icon-left"></i>'+StrackPHP.Shots+'</p><div class="text-sm">'+t.shot_number+'</div></div></div></div></div><div class="proj-c-right"><div class="col-lg-21 no-box-sizing"><div id="epis_chart_'+t.project_id+'" class="projc-chart"></div></div><div class="col-lg-21 no-box-sizing"><div id="seq_chart_'+t.project_id+'" class="projc-chart"></div></div><div class="col-lg-21 no-box-sizing"><div id="pred_chart_'+t.project_id+'" class="projc-chart"></div></div><div class="col-lg-21 no-box-sizing"><div id="asset_chart_'+t.project_id+'" class="projc-chart"></div></div><div class="col-lg-21 no-box-sizing"><div id="shot_chart_'+t.project_id+'" class="projc-chart"></div></div></div></div><div id="projc_progress_'+t.project_id+'" class="ui indicating tiny progress" data-value="'+t.task_done_number+'" data-total="'+t.task_total+'"><div class="bar"></div></div></div>'}!function(){$.ajax({type:"POST",url:ReportPHP.loadReportProj,dataType:"json",data:{},beforeSend:function(){},success:function(t){$("#projc_hold").html(t.hold_num),$("#projc_ip").html(t.ip_num),$("#projc_done").html(t.done_num),$("#projc_ver").html(t.version_num)}})}(),t(1,20,"new")});