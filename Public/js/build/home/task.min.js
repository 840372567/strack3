$(function(){obj={addDefaultTask:function(t){var a={type:"tasks",pid:pid,custom:"yes",multi:"no",etype:8020,upmod:"newDefaultTasks"},e=$(t).data("grid");Strack.open_dialog("dialog",{title:StrackPHP.Add_Task,width:560,height:360,content:Strack.dialog_dom({type:"normal",hidden:[{case:101,id:"Mtype",type:"hidden",name:"type",valid:1,value:a.etype},{case:101,id:"Mproject_id",type:"hidden",name:"project_id",valid:1,value:pid}],items:[{case:1,id:"Mup_fields",type:"text",lang:StrackPHP.Fields,name:"fields",valid:1,value:""}],update:!0,footer:[{obj:"AddNewTask",type:1,title:StrackPHP.Update},{obj:"dialog_cancel",type:8,title:StrackPHP.Cancel},{obj:"save_dialog_setting",type:8,title:StrackPHP.Save_Setting}]}),inits:function(){var t,e=[7726,7738,7700,7733,7716,7720],i=Strack.G.DialogAddSetting[a.etype];t=i&&200==parseInt(i.status)?i.optionValue:e,$("#Mup_fields").combobox({url:StrackPHP.EditFields,width:350,valueField:"id",textField:"lang",multiple:!0,value:"",queryParams:a,onSelect:function(t){if(0==$("#dgup_i_"+t.id).length){var e=Strack.BatchUpItem(t,"new");$("#st_dgup").append(e.item_dom),Strack.BatchItemInit(t,pid,8020,e.id,a.type,t)}},onUnselect:function(t){$.inArray(t.id,e)<0?$("#dgup_i_"+t.id).remove():($(this).combobox("select",t.id),layer.msg(StrackPHP.Must_Field,{icon:2,time:1200,anim:6}))},onLoadSuccess:function(){var a=$(this);t.forEach(function(t){a.combobox("select",t)})}})},close:function(){$("#"+e).datagrid("reload")}})},AddNewTask:function(){var t=$("#Mproject_id").val();Strack.doBatchUpdate("new",t,8020,"newDefaultTasks",!0)},TasksUpdate:function(t){var a=$(t).data("grid"),e=Strack.GetTaskDatagrid(a,"task_id",!0);switch(e.verify){case-1:layer.msg(StrackPHP.E_MULTI_PROJECT,{icon:2,time:1200,anim:6});break;case-2:layer.msg(StrackPHP.E_MULTI_ENTITY,{icon:2,time:1200,anim:6});break;case-3:layer.msg(StrackPHP.Please_Select_One,{icon:2,time:1200,anim:6});break;case 200:Strack.BatchUpDialog("#"+a,StrackPHP.TasksUpdate,e.ids.join(","),{type:"tasks",pid:0,custom:"no",etype:1020,upmod:"myhome",multi:"yes"},StrackPHP.EditFields,e)}},TaskstoTrash:function(t){var a=$("#datagrid_box").datagrid("getSelections"),e=[],i=$(t).data("ftype");a.forEach(function(t){e.push(t.task_id)});var d=StrackPHP.DeAll_Tasks_notice,c=StrackPHP.DeAll_TasksSC;Strack.ajax_grid_delete(a,d,StrackPHP.DeleteTasks,{task_ids:e.join(","),pid:pid,ptype:i},"#datagrid_box",c)}};var t=$("#project_id").val();$("#module_id").val();Strack.verify_project_data(t,$(".projpage-main"),function(t){})});