$(function(){function e(e,a,o,i){switch(t(o),o){case"project":s("sigle_project","project",41,"",i,!1);break;case"projandpeople":s("mult_project","project",41,"",i,!1),s("mult_people","people",0,"user_group",i,!0);break;case"people":s("sigle_people","people",41,"user_group",i,!1)}}function t(e){$("#current_tab").val(e),$(".switch_m_plan").removeClass("active"),$("#tab_"+e).addClass("active"),$(".plan-items").removeClass("plan_m_active").each(function(){$(this).data("tab")==e&&$(this).addClass("plan_m_active")})}function a(e){var t;switch(e){case"project":t=[{labelText:"",field:"thumb",width:85},{labelText:StrackPHP.Project,field:"p_name",width:240}];break;case"people":t=[{labelText:"",field:"avatar",width:85},{labelText:StrackPHP.Name,field:"user_name",width:240}]}return t}function s(e,t,s,c,n,d){var p,f="";H.push(e),$("#"+e).addClass("already_init").fullCalendar({now:n.today,selectable:!0,selectHelper:!0,contentHeight:Strack.panel_height("#"+e,s),editable:!0,aspectRatio:1.8,firstDay:1,slotWidth:50,scrollTime:"00:00",hideHeader:d,header:{left:"today prev,next",center:"title",right:"timelineCweek,timelineCmonth,timelineCyear"},windowResizeDelay:50,windowResize:function(t){setTimeout(function(){var t=Strack.panel_height("#"+e,s+Strack.panel_height("#"+e+" .fc-head",0));$("#"+e+" .fc-body .fc-scroller").css("height",t)},200),$("#mult_project").fullCalendar("option","contentHeight",Strack.panel_height("#mult_project",41)),$("#mult_people").fullCalendar("option","contentHeight",Strack.panel_height("#mult_people",0))},defaultView:n.plan_view,views:u(n),resourceGroupField:c,resourceColumns:a(t),resources:function(a){var s=$("#"+e+" .fc-body .fc-resource-area");jQuery.ajax({url:PlanPHP.PlanResources,type:"POST",dataType:"json",data:{res_name:t,filter:JSON.stringify(j)},beforeSend:function(){s.append(Strack.loading_dom("white","",e)).css("position","relative")},success:function(e){var o,i,l=[],r={thumb_arr:{}};switch(t){case"project":e.res_columns.forEach(function(e){r.thumb_arr.p_folder=e.p_folder,r.thumb_arr.p_thumb=e.p_thumb,i="<div class='plan-cel-name'>"+e.p_name+"</div>",l.push({id:e.project_id,project_id:e.project_id,p_name:i,thumb:Strack.build_thumb_dom(e.p_thumb,r,"min"),eventColor:e.p_bcolor})});break;case"people":e.res_columns.forEach(function(e){o=e.path?'<img class="plan-avatar" src="'+StrackPHP.UPLOADS+"/avatars/"+e.path+'" />':'<span class="plan-avatar">'+Strack.JointLetter(e.first_name,e.last_name)+"</span>",i="<div class='plan-cel-name'>"+e.user_name+"</div>",l.push({id:e.user_id,user_id:e.user_id,user_name:i,avatar:o,user_group:e.scope})})}s.css("position","static").find(".st-load").remove(),a(l)}})},events:function(a,s,o,i){var l=$("#"+e+" .fc-body .fc-time-area");jQuery.ajax({url:PlanPHP.PlanEvents,type:"POST",dataType:"json",data:{res_name:t,filter:JSON.stringify(j)},beforeSend:function(){Strack.DestroyEPanel(),l.append(Strack.loading_dom("white","",e)).css("position","relative").fullCalendar("unselect")},success:function(a){var s,o,r,c,n=[];switch(t){case"project":a.events.project.forEach(function(t){s=JSON.parse(t.scheduler_val),n.push({id:t.scheduler_id,resourceId:s.project_id,project_id:s.project_id,start:s.start_date,end:s.end_date,title:s.description,color:"#"+s.color,cview:e,steps:s.steps,user_ids:s.user_id})});break;case"people":a.events.project.forEach(function(t){s=JSON.parse(t.scheduler_val),r=s.user_id.split(","),r.forEach(function(a){n.push({id:t.scheduler_id,resourceId:a,start:s.start_date,end:s.end_date,title:s.description,color:"#"+s.color,className:"stp-bgevent",rendering:"background",cview:e})})}),a.events.people.forEach(function(t){c=0!=parseInt(t.project_id)&&t.project_id?t.p_bcolor:"",o=JSON.parse(t.scheduler_val),n.push({id:t.scheduler_id,resourceId:o.user_id,user_id:o.user_id,project_id:t.project_id,start:o.start_date,end:o.end_date,title:o.description,color:"#"+c,cview:e,choose_id:o.choose_id})})}l.css("position","static").find(".st-load").remove(),i(n)}})},select:function(t,a,s,o,l){p={},l.project_id?(p.project_id=l.project_id,i(m("add","project_id",l.project_id,_("project",e)),s,"project",t,a,p,"add")):l.user_id&&(p.user_id=l.user_id,i(m("add","user_id",l.user_id,_("people",e)),s,"people",t,a,p,"add"))},eventClick:function(t,a){switch(p={},p.desc=t.title,p.color=t.color,t.cview){case"mult_project":case"sigle_project":p.steps=t.steps,p.user_ids=t.user_ids,p.project_id=t.project_id,i(m("update","project_id",t.project_id,_("project",e,t.id)),a,"project",t.start,t.end,p,"update");break;case"mult_people":case"sigle_people":p.project_id=t.project_id,p.choose_id=t.choose_id,i(m("update","user_id",t.user_id,_("people",e,t.id)),a,"people",t.start,t.end,p,"update")}},eventResize:function(e,t,a,s,i,l){o(e)},eventDrop:function(e,t,a,s,i,l){o(e)},viewRender:function(t,a){f=$(a).closest(".plan-scheduler-half").attr("id"),"mult_project"==f&&$("#mult_people").fullCalendar("changeView",t.name),r(e)},eventMouseover:function(e,t,a){Strack.SchedulerTips(t.currentTarget,e.id)},eventMouseout:function(e,t,a){layer.closeAll("tips")}}),l(e)}function o(e){var t,a,s=e.start.format(),o=e.end.format(),i=e.cview,l={};switch(t=Strack.getTime2Time(o,s),i){case"sigle_project":case"mult_project":a="project",l.color=e.color.substr(1,e.color.length-1),l.description=e.title,l.duration=t,l.event_id=e.id,l.project_id=e.project_id,l.start_date=s,l.steps=e.steps,l.user_id=e.user_ids;break;case"sigle_people":case"mult_people":l.start_date=s,l.duration=t,l.user_id=e.user_id,l.event_id=e.id,l.description=e.title,l.choose_id=e.choose_id,20==parseInt(e.choose_id)?a="vacation":(a="user_task",l.project_id=e.project_id)}b(i,a,l)}function i(e,t,a,s,o,i,l){Strack.DestroyEPanel(),$("body").append(e);var r,c,n="project"==a?265:227,d=document.body.clientHeight-t.pageY,p=document.body.clientWidth-t.pageX;switch(r=d>n?t.pageY+5:document.body.clientHeight-n-25,c=p>420?t.pageX-150:document.body.clientWidth-400,$("#plan_editor").css({top:r,left:c}).slideDown(),$("#date_pick").datebox({width:115,value:s.format()}),$("#date_duration").numberspinner({min:1,width:115,value:Strack.getTime2Time(o.format(),s.format())}),a){case"project":var u=i.color?i.color.substr(1,i.color.length-1):"",_=i.steps?i.steps.split(","):"",m=i.user_ids?i.user_ids.split(","):"";Strack.color_pick_widget("#MD_color","hex","light",u,220),$("#MD_step").combobox({url:PlanPHP.StepsList,valueField:"type_id",textField:"type_name",multiple:!0,value:_,queryParams:{project_id:i.project_id}}),$("#MD_people").combobox({url:PlanPHP.PeopleList,valueField:"uid",textField:"uname",groupField:"deptname",multiple:!0,value:m,queryParams:{project_id:i.project_id}}),"update"==l&&$("#MD_desc").val(i.desc);break;case"people":var f=i.choose_id?i.choose_id:"",h=i.project_id?i.project_id:"",v=$("#MD_project").closest(".st-panel-items");$("#MD_ctype").combobox({data:Strack.JsonChoose(),valueField:"plan_typeid",textField:"plan_typename",value:f,onSelect:function(e){switch(parseInt(e.plan_typeid)){case 10:v.show();break;case 20:v.hide()}}}),$("#MD_project").combobox({url:PlanPHP.ProjectList,valueField:"project_id",textField:"project_name",value:h}),20==parseInt(f)&&v.hide(),"update"==l&&$("#MD_desc").val(i.desc)}}function l(e){if("mult_project"==e){var t=$("#mult_people");$("#"+e+" .fc-today-button").on("click",function(e){e.stopPropagation(),t.fullCalendar("today")}),$("#"+e+" .fc-prev-button").on("click",function(e){e.stopPropagation(),t.fullCalendar("prev")}),$("#"+e+" .fc-next-button").on("click",function(e){e.stopPropagation(),t.fullCalendar("next")}),c()}}function r(e){var t=$("#"+e+" .fc-body .fc-time-area .fc-scroller"),a=$("#"+e+" .fc-body .fc-resource-area .fc-scroller");switch(e){case"mult_project":var s=$("#mult_people .fc-body .fc-time-area .fc-scroller"),o=$("#mult_people .fc-body .fc-resource-area .fc-scroller");t.on("scroll",function(e){e.stopPropagation(),s.scrollLeft($(this).scrollLeft())}),a.on("scroll",function(e){e.stopPropagation(),o.scrollLeft($(this).scrollLeft())});break;case"mult_people":var i=$("#mult_project .fc-body .fc-time-area .fc-scroller"),l=$("#mult_project .fc-body .fc-resource-area .fc-scroller");t.on("scroll",function(e){e.stopPropagation(),i.scrollLeft($(this).scrollLeft())}),a.on("scroll",function(e){e.stopPropagation(),l.scrollLeft($(this).scrollLeft())})}}function c(){$("#horiz_handle").on("mousedown",function(e){e.preventDefault(),e.stopPropagation();var t,a,s,o,i,l,r,c,n=$("#horiz_handle_fake");n.show(),$(document).on("mousemove",function(e){t=e.pageY-200,a=(document.body.clientHeight-108)/2,s=document.body.clientHeight-e.pageY-55,o=a-(e.pageY-112),i=a-(document.body.clientHeight-e.pageY-4),l=e.pageY-108,t>0&&n.css("top",l+"px")}).on("mouseup",function(e){$(this).off("mousemove"),n.hide(),t>0&&(r=o>0?"50% - "+o+"px":"50% + "+Math.abs(o)+"px",$("#mult_project .fc-body .fc-scroller").css("height",t),$("#mult_project").css("height","calc("+r+")").fullCalendar("option","contentHeight",t+50)),s>0&&t>0&&(c=i>0?"50% - "+i+"px":"50% + "+Math.abs(i)+"px",$("#mult_people .fc-body .fc-scroller").css("height",s),$("#mult_people").css("height","calc("+c+")").fullCalendar("option","contentHeight",s+50))})})}function n(){$.ajax({type:"POST",url:PlanPHP.PlanFilters,beforeSend:function(){$("#plan_filters").append(Strack.loading_dom("white","","fplan"))},success:function(e){var t=JSON.parse(e);$("#plan_scope").combobox({data:t.scope,valueField:"scope_id",textField:"scope_name",multiple:!0,width:242,height:25,onSelect:function(e){d("scopes",Strack.get_combos_val(this,"combobox","getValues"))},onUnselect:function(e){d("scopes",Strack.get_combos_val(this,"combobox","getValues"))}}),$("#plan_project").combobox({data:t.project,valueField:"project_id",textField:"project_name",multiple:!0,width:242,height:25,onSelect:function(e){p(Strack.get_combos_val(this,"combobox","getValues"))},onUnselect:function(e){p(Strack.get_combos_val(this,"combobox","getValues"))}}),$("#plan_users").combobox({data:t.users,valueField:"user_id",textField:"uname",groupField:"deptname",multiple:!0,width:242,height:25,queryParams:{scope_id:""},formatter:function(e){return Strack.build_comb_avatar(e)},onSelect:function(e){d("users",Strack.get_combos_val(this,"combobox","getValues"))},onUnselect:function(e){d("users",Strack.get_combos_val(this,"combobox","getValues"))}}),$("#st-load_fplan").remove()}})}function d(e,t){switch(e){case"scopes":t.length>0?j.resources.scopes=t.join(","):j.resources.scopes="";break;case"users":t.length>0?j.resources.user_ids=t.join(","):j.resources.user_ids=""}var a,s=$(".plan_m_active").data("tab");switch(s){case"projandpeople":a=$("#mult_people");break;case"people":a=$("#sigle_people")}a.fullCalendar("refetchResources"),a.fullCalendar("refetchEvents")}function p(e){e.length>0?j.resources.project_ids=e.join(","):j.resources.project_ids="";var t,a=$(".plan_m_active").data("tab");switch(a){case"project":t=$("#sigle_project");break;case"projandpeople":t=$("#mult_project")}t.fullCalendar("refetchResources"),t.fullCalendar("refetchEvents")}function u(e){return{timelineCday:{type:"timeline",duration:{days:30},timesteps:"hour",buttonText:"day"},timelineCweek:{type:"timeline",duration:{weeks:e.cweek},timesteps:"day",buttonText:StrackPHP.Week},timelineCmonth:{type:"timeline",duration:{months:e.cmonth},timesteps:"week",buttonText:StrackPHP.Month},timelineCyear:{type:"timeline",duration:{years:e.cyear},timesteps:"month",buttonText:StrackPHP.Year}}}function _(e,t,a){var s,o;switch(o=a||0,e){case"project":s={item_list:[{title:StrackPHP.Description,id_name:"MD_desc",data_name:"description"},{title:StrackPHP.Color,id_name:"MD_color",data_name:"color"},{title:StrackPHP.Task_Steps,id_name:"MD_step",data_name:"task_step"},{title:StrackPHP.People,id_name:"MD_people",data_name:"user_id"}],view:t,edit_type:e,event_id:o};break;case"people":s={item_list:[{title:StrackPHP.ChooseType,id_name:"MD_ctype",data_name:"ctype"},{title:StrackPHP.Description,id_name:"MD_desc",data_name:"description"},{title:StrackPHP.Project,id_name:"MD_project",data_name:"project_id"}],view:t,edit_type:e,event_id:o}}return s}function m(e,t,a,s){var o="";return o+='<div id="plan_editor" class="st-e-panel e-panel-shadow ste_mode" data-view="'+s.view+'"><input id="re_name" name="'+t+'" value="'+a+'" type="hidden"/><div class="st-e-editor ste_mode"><div class="ste-timefields ste_mode"><div class="ste-time-date aign-left ste_mode"><input id="date_pick" class="ste_mode"/></div><div class="ste-time-range aign-left ste_mode"><input id="date_duration" class="ste_mode"></div><div class="ste-time-unit aign-left ste_mode">'+PlanPHP.Days+'</div></div><div class="ste-formlist ste_mode">'+h(s.item_list)+'</div></div><div class="st-e-footer ste_mode">'+f(e,s)+"</div></div>"}function f(e,t){var a="";return"update"==e&&(a+='<div class="st-dialog-lfooter ste_mode"><a href="javascript:;" class="st-dialog-button st-button-base button-dgsstop" onclick="obj.DeleteEvent(this);" data-eid="'+t.event_id+'" data-view="'+t.view+'">'+StrackPHP.Deleted+"</a></div>"),a+='<div class="st-dialog-footer ste_mode">',"update"==e?a+='<a href="javascript:;" class="st-dialog-button st-button-base button-dgsub" onclick="obj.UpdateEvent(this);"  data-eid="'+t.event_id+'" data-type="'+t.edit_type+'" data-view="'+t.view+'">'+StrackPHP.Update+"</a>":"add"==e&&(a+='<a href="javascript:;" class="st-dialog-button st-button-base button-dgsub" onclick="obj.AddNewEvent(this);" data-type="'+t.edit_type+'" data-view="'+t.view+'">'+StrackPHP.Submit+"</a>"),a+='<a href="javascript:;" class="st-dialog-button st-button-base button-dgcel" onclick="Strack.Panelcancel(this);" data-view="'+t.view+'" >'+StrackPHP.Cancel+"</a></div>"}function h(e){var t="";return e.forEach(function(e){t+=v(e)}),t}function v(e){var t="";return t+='<div class="st-panel-items ste_mode"><div class="st-panel-name aign-left ste_mode">'+e.title+'</div><div class="st-panel-input aign-left ste_mode"><input id="'+e.id_name+'" class="ste_mode" autocomplete="off" data-name="'+e.data_name+'" value="" type="text"></div></div>'}function P(e){var t={},a="";switch(t.start_date=$("#date_pick").datebox("getValue"),t.duration=$("#date_duration").numberspinner("getValue"),e){case"sigle_project":case"mult_project":t.project_id=$("#re_name").val(),t.description=$("#MD_desc").val(),t.color=$("#MD_color").val(),t.steps=Strack.get_combos_val("#MD_step","combobox","getValues"),t.user_id=Strack.get_combos_val("#MD_people","combobox","getValues"),t.steps&&(t.steps=t.steps.join(",")),t.user_id&&(t.user_id=t.user_id.join(",")),a="project";break;case"sigle_people":case"mult_people":t.user_id=$("#re_name").val(),t.choose_id=Strack.get_combos_val("#MD_ctype","combobox","getValue"),t.description=$("#MD_desc").val(),20!=t.choose_id?(t.project_id=Strack.get_combos_val("#MD_project","combobox","getValue"),a="user_task"):a="vacation"}return{add_data:t,cmode:a}}function g(e,t,a,s){var o=!1;if(a.start_date.length<1)layer.msg(PlanPHP.Plan_StartDate_Null,{icon:2,time:1200,anim:6});else if(a.duration.length<1)layer.msg(PlanPHP.Plan_Duration_Null,{icon:2,time:1200,anim:6});else{switch(t){case"project":a.description.length<1?layer.msg(PlanPHP.Plan_Desc_Null,{icon:2,time:1200,anim:6}):a.color.length<1?layer.msg(PlanPHP.Plan_Color_Null,{icon:2,time:1200,anim:6}):a.steps.length<1?layer.msg(PlanPHP.Plan_Steps_Null,{icon:2,time:1200,anim:6}):a.user_id.length<1?layer.msg(PlanPHP.Plan_User_Null,{icon:2,time:1200,anim:6}):o=!0;break;case"user_task":a.choose_id.length<1?layer.msg(PlanPHP.Plan_Choose_Null,{icon:2,time:1200,anim:6}):a.description.length<1?layer.msg(PlanPHP.Plan_Desc_Null,{icon:2,time:1200,anim:6}):a.project_id.length<1?layer.msg(PlanPHP.Plan_Proj_Null,{icon:2,time:1200,anim:6}):o=!0;break;case"vacation":a.choose_id.length<1?layer.msg(PlanPHP.Plan_Choose_Null,{icon:2,time:1200,anim:6}):a.description.length<1?layer.msg(PlanPHP.Plan_Desc_Null,{icon:2,time:1200,anim:6}):o=!0}if(o)switch(s){case"add":k(e,t,a);break;case"update":b(e,t,a)}}}function b(e,t,a){$.ajax({type:"POST",url:PlanPHP.UpdateEvent,data:{mode:t,event_id:a.event_id,data:JSON.stringify(a)},beforeSend:function(){$.messager.progress({title:StrackPHP.Waiting,msg:StrackPHP.loading})},success:function(s){var o=JSON.parse(s);$.messager.progress("close"),y("update",t,e,o,a)}})}function k(e,t,a){$.ajax({type:"POST",url:PlanPHP.AddNewEvent,data:{mode:t,data:JSON.stringify(a)},beforeSend:function(){$.messager.progress({title:StrackPHP.Waiting,msg:StrackPHP.loading})},success:function(s){var o=JSON.parse(s);$.messager.progress("close"),y("add",t,e,o,a)}})}function y(e,t,a,s,o){var i=s.data;switch(parseInt(s.status)){case-1:layer.msg(PlanPHP.Plan_StartDate_Null,{icon:2,time:1200,anim:6});break;case-2:layer.msg(PlanPHP.Plan_Duration_Null,{icon:2,time:1200,anim:6});break;case-3:layer.msg(PlanPHP.Plan_Desc_Null,{icon:2,time:1200,anim:6});break;case-4:layer.msg(PlanPHP.Plan_Color_Null,{icon:2,time:1200,anim:6});break;case-5:layer.msg(PlanPHP.Plan_Steps_Null,{icon:2,time:1200,anim:6});break;case-6:layer.msg(PlanPHP.Plan_User_Null,{icon:2,time:1200,anim:6});break;case-7:layer.msg(PlanPHP.Plan_Choose_Null,{icon:2,time:1200,anim:6});break;case-8:layer.msg(PlanPHP.Plan_Proj_Null,{icon:2,time:1200,anim:6});break;case 200:switch(e){case"add":switch(t){case"project":$("#"+a).fullCalendar("refetchEvents"),"mult_project"==a&&$("#mult_people").fullCalendar("refetchEvents");break;case"user_task":case"vacation":$("#"+a).fullCalendar("refetchEvents")}break;case"update":switch(t){case"project":var l=$("#"+a).fullCalendar("clientEvents",i.scheduler_id)[0];l.start=i.start_date,l.end=i.end_date,l.title=i.description,l.color="#"+i.color,l.steps=o.steps,l.user_ids=o.user_id,$("#"+a).fullCalendar("updateEvent",l),"mult_project"==a&&$("#mult_people").fullCalendar("refetchEvents");break;case"user_task":case"vacation":var r=$("#"+a).fullCalendar("clientEvents",i.scheduler_id)[0];r.start=i.start_date,r.title=i.description,r.end=i.end_date,r.project_id=i.project_id,r.choose_id=o.choose_id,r.color="#"+i.p_bcolor,$("#"+a).fullCalendar("updateEvent",r)}}}Strack.Panelclose(a)}obj={planFilter:function(){var e=$("#page_right"),t=$("#page_left"),a=$(".plan-items");e.hasClass("panel-show")?(e.hide().removeClass("panel-show"),t.css("width","100%"),a.css("width","100%")):(e.show().addClass("panel-show"),t.css("width","calc(100% - 280px)"),a.css("width","calc(100% - 280px)")),e.hasClass("pfilter_active")||(n(),e.addClass("pfilter_active"))},PlanFiterReset:function(){$("#plan_scope").combobox("clear"),$("#plan_project").combobox("clear"),$("#plan_users").combobox("clear"),j.resources.scopes="",j.resources.project_ids="",j.resources.user_ids="";var e=$("#sigle_project");e.fullCalendar("refetchResources"),e.fullCalendar("refetchEvents");var t=$("#mult_project"),a=$("#mult_people");t.fullCalendar("refetchResources"),a.fullCalendar("refetchResources"),t.fullCalendar("refetchEvents"),a.fullCalendar("refetchEvents");var s=$("#sigle_people");s.fullCalendar("refetchResources"),s.fullCalendar("refetchEvents")},switchPlanmode:function(a){var s,o=$(a).data("tab");switch(Strack.DestroyEPanel(),o){case"project":$("#filter_project").show(),$("#filter_scope").hide(),$("#filter_users").hide(),s="sigle_project";break;case"projandpeople":$("#filter_project").show(),$("#filter_scope").show(),$("#filter_users").show(),s="mult_project";break;case"people":$("#filter_project").hide(),$("#filter_scope").show(),$("#filter_users").show(),s="sigle_people"}$("#"+s).hasClass("already_init")?(t(o),$("#mult_project").fullCalendar("render")):e(S,C,o,j)},AddNewEvent:function(e){var t=$(e).data("view"),a=P(t);g(t,a.cmode,a.add_data,"add")},UpdateEvent:function(e){var t=$(e).data("view"),a=$(e).data("eid"),s=P(t);s.add_data.event_id=a,g(t,s.cmode,s.add_data,"update")},DeleteEvent:function(e){var t=$(e).data("eid"),a=$(e).data("view");t&&$.ajax({type:"POST",url:PlanPHP.DeletedEvent,data:{event_id:t},beforeSend:function(){$.messager.progress({title:StrackPHP.Waiting,msg:StrackPHP.loading})},success:function(e){var s=JSON.parse(e);switch(parseInt(s.status)){case 400:layer.msg(StrackPHP.Illegal_Operation,{icon:2,time:1200,anim:6});break;case 200:$("#"+a).fullCalendar("removeEvents",t),"mult_project"==a&&$("#mult_people").fullCalendar("removeEvents",t),Strack.Panelclose(a)}$.messager.progress("close")}})}};var w=$("#tac_plan");w.show();var j,S=Strack.DateFormat(new Date,"yyyy-MM-dd"),C="timelineCweek",H=[];e(S,C,"projandpeople",function(e,t){switch(e){case"timelineCweek":12;break;case"timelineCmonth":6;break;case"timelineCyear":3}return $("#plans_sdate").datebox({value:t,onSelect:function(e){var t=Strack.DateFormat(e,"yyyy-MM-dd");j.gstart=t,H.forEach(function(e){$("#"+e).fullCalendar("gotoDate",t)})}}),j={today:t,gstart:t,cweek:12,cmonth:6,cyear:3,plan_view:e,resources:{project_ids:"",scopes:"",user_ids:""}}}(C,S))});