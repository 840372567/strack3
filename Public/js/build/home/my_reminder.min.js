$(function(){function t(t){switch(t){case"yes":return!0;case"no":return!1}}function e(t,e){var c=e?"yes":"no";$.ajax({type:"POST",url:AccountPHP.upAccountSetting,data:{setField:t,setVal:c},dataType:"json",success:function(t){Strack.top_message({bg:"g",msg:AccountPHP.Account_Reminder_Save_SC})}})}obj={setProjStatus:function(){var t=$("#my_project").combobox("getValue");if(t>0){var e=$("#pstatus_set").datagrid("getData");$.ajax({type:"POST",url:AccountPHP.setProjectStatus,dataType:"json",data:{project_id:t,setData:JSON.stringify(e.rows)},success:function(t){Strack.top_message({bg:"g",msg:AccountPHP.Save_Status_Reminder_SC}),$("#pstatus_set").datagrid("reload")}})}else layer.msg(AccountPHP.Project_None_Warning,{icon:2,time:1200,anim:6})},change_field_col:function(t){$(".iex_text").on("blur",function(){var e=$(this).attr("data-index"),c=$("#"+t).datagrid("selectRow",e).datagrid("getSelected"),a=$(this).closest("td").attr("field"),n="";n=$(this).is(":checked")?"yes":"no",c[a]=n,$("#"+t).datagrid("updateRow",{index:e,row:c}),$(".iex_text").off("blur"),obj.change_field_col(t)})}},function(){var a=$("#pstatus_set");$.ajax({type:"POST",url:AccountPHP.getAccountSetting,dataType:"json",beforeSend:function(){$(".account-page-right").append(Strack.loading_dom("white","","reminder"))},success:function(n){$("#st-load_reminder").remove(),$("#msg_set_notice").switchbutton({width:88,disabled:c,checked:t(n.notifications),onChange:function(t){e("notifications",t)}}),$("#mset_sys_atcc").switchbutton({width:88,disabled:c,checked:t(n.atcc_msg),onChange:function(t){e("atcc_msg",t)}}),$("#mset_mail_atcc").switchbutton({width:88,disabled:c,checked:t(n.atcc_mail),onChange:function(t){e("atcc_mail",t)}}),$("#mset_sys_task").switchbutton({width:88,disabled:c,checked:t(n.mytask_msg),onChange:function(t){e("mytask_msg",t)}}),$("#mset_mail_task").switchbutton({width:88,disabled:c,checked:t(n.mytask_mail),onChange:function(t){e("mytask_mail",t)}}),$("#mset_sys_note").switchbutton({width:88,disabled:c,checked:t(n.note_msg),onChange:function(t){e("note_msg",t)}}),$("#mset_mail_note").switchbutton({width:88,disabled:c,checked:t(n.note_mail),onChange:function(t){e("note_mail",t)}}),$("#mset_sys_plan").switchbutton({width:88,disabled:c,checked:t(n.myplan_msg),onChange:function(t){e("myplan_msg",t)}}),$("#mset_mail_plan").switchbutton({width:88,disabled:c,checked:t(n.myplan_mail),onChange:function(t){e("myplan_mail",t)}}),$("#my_project").combobox({url:AccountPHP.loadRecentProject,width:270,height:30,disabled:c,valueField:"project_id",textField:"p_name",prompt:AccountPHP.Select_Project,onSelect:function(t){a.datagrid("reload",{project_id:t.project_id})}}),c||a.datagrid({url:AccountPHP.ProjStatusTemp,width:760,height:360,rowheight:30,DragSelect:!0,queryParams:{project_id:0},columns:[[{field:"status_id",checkbox:!0},{field:"status_name",title:StrackPHP.Status,width:260,align:"center"},{field:"status_sys",title:AccountPHP.System_Reminder,width:180,align:"center",formatter:function(e,c,a){return'<input class="iex_text" type="checkbox"  '+(t(e)?'checked = "checked"':"")+' data-index="'+a+'">'}},{field:"status_mail",title:AccountPHP.Mail_Reminder,width:180,align:"center",formatter:function(e,c,a){return'<input class="iex_text" type="checkbox" '+(t(e)?'checked = "checked"':"")+' data-index="'+a+'">'}}]],toolbar:"#tb_list",onLoadSuccess:function(t){obj.change_field_col("pstatus_set")}})}})}();var c=!1;"no"==PARSE_VAR.rules.usermsg_set.allow&&(c=!0,$(".ah_usermsg_set").remove())});